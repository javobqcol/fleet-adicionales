<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <record id="fleet_vehicle_viaje_view_form" model="ir.ui.view">
      <field name="name">fleet.vehicle.viaje.view.form</field>
      <field name="model">fleet.vehicle.viaje</field>
      <field name="arch" type="xml">
        <form string="Viajes">
          <sheet>
            <group col="2">
              <group>
                 <field name="vehicle_id"
                       string="Vehiculo"/>
                <field name="driver_id"
                       string="Conductor"/>
                <field name="company_id"
                       string="Compañia"
                       groups="base.group_multi_company"
                       options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
                <field name="work_id" string="Trabajo"/>
                <field name="material_id"/>
                <label for="m3"/>
                <div class="o_row">
                  <field name="m3" digits="[10,2]"/>
                  <field name="unidad"/>
                </div>
               <field name="cantera_id" placeholder="Sitio de carga"/>
                <field name="destino_id" placeholder="Sitio de descarga"/>

              </group>
              <group>
                <field name="date" string="Fecha"/>
                <field name="recibo_interno" string="Recibo interno" placeholder="Número recibo interno"/>
                <field name="recibo_cantera" string="Recibo cantera" placeholder="Número recibo cantera"/>
                <field name="Km_inicial"/>
                <field name="Km_final"/>
                <field name="km_recorridos"/>
                <field name="galones" digits="[10,2]"/>
                <field name="viajes" />
                <field name="total_cantidad" digits="[10,2]" groups="fleet.fleet_group_manager"/>
                <field name="viaje_cancelado" groups="base.group_multi_company"/>
                <field name="liq_id" string="liq" optional="hide" groups="base.group_multi_company"/>
              </group>
            </group>
            <notebook>
              <page string="Archivos Adjuntos">
                <field name="documentos_ids" widget="many2many_binary"/>
              </page>
              <page string="Notas">
                <field name="descripcion" nolabel="1" placeholder="Describa cualquier informacion adicional de la compra de combustible"/>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fleet_vehicle_viaje_view_tree" model="ir.ui.view">
      <field name="name">fleet.vehicle.viaje.tree</field>
      <field name="model">fleet.vehicle.viaje</field>
      <field name="arch" type="xml">
        <tree string="Viajes" decoration-muted="viaje_cancelado == True" >
          <field name="date" string="Fecha"/>
          <field name="vehicle_id" string="Vehiculo"/>
          <field name="driver_id" string="Conductor" optional="show"/>
          <field name="company_id" groups="base.group_multi_company" optional="show"/>
          <field name="work_id" string="Trabajo" optional="show"/>
          <field name="cantera_id" optional="show"/>
          <field name="destino_id" optional="show"/>
          <field name="recibo_cantera" string="Cantera" optional="show"/>
          <field name="recibo_interno" string="Interno" optional="show"/>
          <field name="material_id" string="Material" optional="show"/>
          <field name="viajes" string="Viajes" sum="Total viajes" optional="show"/>
          <field name="km_recorridos" string="KM" sum="Total KM" optional="hide"/>
          <field name="total_cantidad" string="Cant" digits="[10,2]" optional="show"/>
          <field name="viaje_cancelado" string="Liq?" optional="show"/>
          <field name="tiene_adjunto" string="Adj?" optional="show"/>
          <field name="liq_id" string="liq" optional="hide" groups="base.group_multi_company"/>
        </tree>
      </field>
    </record>

    <record id="fleet_vehicle_viaje_view_search" model="ir.ui.view">
     <field name="name">fleet.vehicle.viaje.view.search</field>
     <field name="model">fleet.vehicle.viaje</field>
     <field name="arch" type="xml">
       <search string="Viajes diarios realizados por los automotores">
         <field name="vehicle_id"
                string="Vehiculo"
                filter_domain="[('vehicle_id','ilike',self)]"/>
         <field name="recibo_interno"
                string="Recibo interno"
                filter_domain="[('recibo_interno','ilike',self)]"/>
         <field name="recibo_cantera"
                string="Recibo cantera"
                filter_domain="[('recibo_cantera','ilike',self)]"/>
         <field name="company_id"
                string="Compañia"
                groups="base.group_multi_company"
                filter_domain="[('company_id.name','ilike',self)]"/>
         <field name="work_id"
                string="Trabajo"
                filter_domain="[('work_id','ilike',self)]"/>
         <field name="driver_id"
                string="Conductor"
                filter_domain="[('driver_id','ilike',self)]"/>
         <field name="cantera_id"
                string="Origen"
                filter_domain="[('cantera_id','ilike',self)]"/>
         <field name="destino_id"
                string="Destino"
                filter_domain="[('destino_id','ilike',self)]"/>
         <field name="material_id"
                string="Material trasportado"
                filter_domain="[('material_id','ilike',self)]"/>

         <group expand="1" string="Agrupado por">
           <filter name="groupby_company_id"
                   context="{'group_by': 'company_id'}"
                   string="Compañia"
                   groups="base.group_multi_company"/>
           <filter name="groupby_vehicle_id"
                   context="{'group_by': 'vehicle_id'}"
                   string="Vehiculo"/>
           <filter name="groupby_driver_id"
                   context="{'group_by': 'driver_id'}"
                   string="Conductor"/>
           <filter name="groupby_work_id"
                   context="{'group_by': 'work_id'}"
                   string="Trabajo"/>
           <filter name="groupby_material_id"
                   context="{'group_by': 'material_id'}"
                   string="Material"/>
         </group>
       </search>
     </field>
    </record>

    <record id='fleet_vehicle_viaje_view_pivot' model='ir.ui.view'>
      <field name="name">fleet.vehicle.viaje.pivot</field>
      <field name="model">fleet.vehicle.viaje</field>
        <field name="arch" type="xml">
          <pivot string="Viajes de los vehiculos" >
            <field name="work_id" type="row"/>
            <field name="material_id" type="row"/>
            <field name="vehicle_id" type="row"/>
            <field name="date" interval="day" type="col"/>
            <field name="viajes" string="Viajes" type="measure"/>
          </pivot>
        </field>
      </record>


    <record id='fleet_vehicle_viajes_action' model='ir.actions.act_window'>
      <field name="name">Registro de viajes de los vehiculos</field>
      <field name="res_model">fleet.vehicle.viaje</field>
      <field name="view_mode">tree,form,pivot</field>
      <field name="search_view_id" ref="fleet_vehicle_viaje_view_search"/>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          Ingrese un nuevo viaje de vehiculo
        </p><p>
          Rastree todos los viajes realizados por los vehiculos.
        </p>
      </field>
    </record>
    <menuitem action="fleet_vehicle_viajes_action" parent="fleet.fleet_vehicles" id="fleet_vehicle_viaje_menu"/>


  </data>
</odoo>

